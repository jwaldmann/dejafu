<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Control.Monad.Conc.SCT.Tests</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Control-Monad-Conc-SCT-Tests.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Control-Monad-Conc-SCT-Tests.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">monad-conc-0.0.0.0: Overloadable primitives for potentially non-deterministic concurrency.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Control.Monad.Conc.SCT.Tests</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Test cases
</a></li><li><a href="#g:2">Predicates
</a></li><li><a href="#g:3">Utilities
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Useful functions for writing SCT test cases for <code>Conc</code>
 computations.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:doTests">doTests</a> :: Show a =&gt; Bool -&gt; [(String, <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)] -&gt; IO Bool</li><li class="src short"><span class="keyword">data</span>  <a href="#t:Result">Result</a> a = <a href="#v:Result">Result</a> {<ul class="subs"><li><a href="#v:_pass">_pass</a> :: Bool</li><li><a href="#v:_casesChecked">_casesChecked</a> :: Int</li><li><a href="#v:_casesTotal">_casesTotal</a> :: Int</li><li><a href="#v:_failures">_failures</a> :: [(Maybe a, <a href="Control-Monad-Conc-SCT.html#t:SCTTrace">SCTTrace</a>)]</li></ul>}</li><li class="src short"><a href="#v:runTest">runTest</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; (<span class="keyword">forall</span> t.  <a href="Control-Monad-Conc-Fixed-ST.html#t:Conc">Conc</a> t a) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a</li><li class="src short"><a href="#v:runTestIO">runTestIO</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; (<span class="keyword">forall</span> t.  <a href="Control-Monad-Conc-Fixed-IO.html#t:Conc">Conc</a> t a) -&gt; IO (<a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)</li><li class="src short"><a href="#v:runTest-39-">runTest'</a> ::  Int -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; (<span class="keyword">forall</span> t.  <a href="Control-Monad-Conc-Fixed-ST.html#t:Conc">Conc</a> t a) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a</li><li class="src short"><a href="#v:runTestIO-39-">runTestIO'</a> ::  Int -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; (<span class="keyword">forall</span> t.  <a href="Control-Monad-Conc-Fixed-IO.html#t:Conc">Conc</a> t a) -&gt; IO (<a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)</li><li class="src short"><span class="keyword">type</span> <a href="#t:Predicate">Predicate</a> a = [(Maybe a, <a href="Control-Monad-Conc-SCT.html#t:SCTTrace">SCTTrace</a>)] -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a</li><li class="src short"><a href="#v:deadlocksNever">deadlocksNever</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:deadlocksAlways">deadlocksAlways</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:deadlocksSometimes">deadlocksSometimes</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:alwaysSame">alwaysSame</a> :: Eq a =&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:alwaysTrue">alwaysTrue</a> ::  (Maybe a -&gt; Bool) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:alwaysTrue2">alwaysTrue2</a> ::  (Maybe a -&gt; Maybe a -&gt; Bool) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:somewhereTrue">somewhereTrue</a> ::  (Maybe a -&gt; Bool) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:somewhereTrue2">somewhereTrue2</a> ::  (Maybe a -&gt; Maybe a -&gt; Bool) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:pAnd">pAnd</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:pNot">pNot</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a</li><li class="src short"><a href="#v:rForgetful">rForgetful</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> ()</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a name="v:doTests" class="def">doTests</a><a href="src/Control-Monad-Conc-SCT-Tests.html#doTests" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Show a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; Bool</td><td class="doc"><p>Whether to print test passes.
</p></td></tr><tr><td class="src">-&gt; [(String, <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)]</td><td class="doc"><p>The test cases
</p></td></tr><tr><td class="src">-&gt; IO Bool</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Run a collection of tests (with a pb of 2), printing results to
 stdout, and returning <code>True</code> iff all tests pass.
</p></div></div><h1 id="g:1">Test cases
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Result" class="def">Result</a> a <a href="src/Control-Monad-Conc-SCT-Tests.html#Result" class="link">Source</a></p><div class="doc"><p>The results of a test, including information on the number of
 cases checked, and number of total cases. Be careful if using the
 total number of cases, as that value may be very big, and (due to
 laziness) will actually force a lot more computation!.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Result" class="def">Result</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:_pass" class="def">_pass</a> :: Bool</dt><dd class="doc"><p>Whether the test passed or not.
</p></dd><dt class="src"><a name="v:_casesChecked" class="def">_casesChecked</a> :: Int</dt><dd class="doc"><p>The number of cases checked.
</p></dd><dt class="src"><a name="v:_casesTotal" class="def">_casesTotal</a> :: Int</dt><dd class="doc"><p>The total number of cases.
</p></dd><dt class="src"><a name="v:_failures" class="def">_failures</a> :: [(Maybe a, <a href="Control-Monad-Conc-SCT.html#t:SCTTrace">SCTTrace</a>)]</dt><dd class="doc"><p>The failed cases, if any.
</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Result" class="caption collapser" onclick="toggleSection('i:Result')">Instances</p><div id="section.i:Result" class="show"><table><tr><td class="src">Functor <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Eq a =&gt; Eq (<a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show a =&gt; Show (<a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">NFData a =&gt; NFData (<a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:runTest" class="def">runTest</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; (<span class="keyword">forall</span> t.  <a href="Control-Monad-Conc-Fixed-ST.html#t:Conc">Conc</a> t a) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#runTest" class="link">Source</a></p><div class="doc"><p>Run a test using the pre-emption bounding scheduler, with a bound
 of 2.
</p></div></div><div class="top"><p class="src"><a name="v:runTestIO" class="def">runTestIO</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; (<span class="keyword">forall</span> t.  <a href="Control-Monad-Conc-Fixed-IO.html#t:Conc">Conc</a> t a) -&gt; IO (<a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)<a href="src/Control-Monad-Conc-SCT-Tests.html#runTestIO" class="link">Source</a></p><div class="doc"><p>Variant of <code><a href="Control-Monad-Conc-SCT-Tests.html#v:runTest">runTest</a></code> using <code>IO</code>. See usual caveats about <code>IO</code>.
</p></div></div><div class="top"><p class="src"><a name="v:runTest-39-" class="def">runTest'</a> ::  Int -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; (<span class="keyword">forall</span> t.  <a href="Control-Monad-Conc-Fixed-ST.html#t:Conc">Conc</a> t a) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#runTest%27" class="link">Source</a></p><div class="doc"><p>Run a test using the pre-emption bounding scheduler.
</p></div></div><div class="top"><p class="src"><a name="v:runTestIO-39-" class="def">runTestIO'</a> ::  Int -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; (<span class="keyword">forall</span> t.  <a href="Control-Monad-Conc-Fixed-IO.html#t:Conc">Conc</a> t a) -&gt; IO (<a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a)<a href="src/Control-Monad-Conc-SCT-Tests.html#runTestIO%27" class="link">Source</a></p><div class="doc"><p>Variant of <code><a href="Control-Monad-Conc-SCT-Tests.html#v:runTest-39-">runTest'</a></code> using <code>IO</code>. See usual caveats about <code>IO</code>.
</p></div></div><h1 id="g:2">Predicates
</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Predicate" class="def">Predicate</a> a = [(Maybe a, <a href="Control-Monad-Conc-SCT.html#t:SCTTrace">SCTTrace</a>)] -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#Predicate" class="link">Source</a></p><div class="doc"><p>A <code>Predicate</code> is a function which collapses a list of results
 into a <code><a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:deadlocksNever" class="def">deadlocksNever</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#deadlocksNever" class="link">Source</a></p><div class="doc"><p>Check that a computation never deadlocks.
</p></div></div><div class="top"><p class="src"><a name="v:deadlocksAlways" class="def">deadlocksAlways</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#deadlocksAlways" class="link">Source</a></p><div class="doc"><p>Check that a computation always deadlocks.
</p></div></div><div class="top"><p class="src"><a name="v:deadlocksSometimes" class="def">deadlocksSometimes</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#deadlocksSometimes" class="link">Source</a></p><div class="doc"><p>Check that a computation deadlocks at least once.
</p></div></div><div class="top"><p class="src"><a name="v:alwaysSame" class="def">alwaysSame</a> :: Eq a =&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#alwaysSame" class="link">Source</a></p><div class="doc"><p>Check that the result of a computation is always the same. In
 particular this means either: (a) it always deadlocks, or (b) the
 result is always <code>Just</code> <code>x</code>, for some fixed <code>x</code>.
</p></div></div><div class="top"><p class="src"><a name="v:alwaysTrue" class="def">alwaysTrue</a> ::  (Maybe a -&gt; Bool) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#alwaysTrue" class="link">Source</a></p><div class="doc"><p>Check that the result of a unary boolean predicate is always
 true. An empty list of results counts as <code>True</code>.
</p></div></div><div class="top"><p class="src"><a name="v:alwaysTrue2" class="def">alwaysTrue2</a> ::  (Maybe a -&gt; Maybe a -&gt; Bool) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#alwaysTrue2" class="link">Source</a></p><div class="doc"><p>Check that the result of a binary boolean predicate is always
 true between adjacent pairs of results. An empty list of results
 counts as <code>True</code>.
</p><p>If the predicate fails, *both* (result,trace) tuples will be added
 to the failures list.
</p></div></div><div class="top"><p class="src"><a name="v:somewhereTrue" class="def">somewhereTrue</a> ::  (Maybe a -&gt; Bool) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#somewhereTrue" class="link">Source</a></p><div class="doc"><p>Check that the result of a unary boolean predicate is true at
 least once. An empty list of results counts as <code>False</code>.
</p></div></div><div class="top"><p class="src"><a name="v:somewhereTrue2" class="def">somewhereTrue2</a> ::  (Maybe a -&gt; Maybe a -&gt; Bool) -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#somewhereTrue2" class="link">Source</a></p><div class="doc"><p>Check that the result of a binary boolean predicate is true
 between at least one adjacent pair of results. An empty list of
 results counts as <code>False</code>.
</p><p>If the predicate fails, *both* (result,trace) tuples will be added
 to the failures list.
</p></div></div><h1 id="g:3">Utilities
</h1><div class="top"><p class="src"><a name="v:pAnd" class="def">pAnd</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#pAnd" class="link">Source</a></p><div class="doc"><p>Compose two predicates sequentially.
</p></div></div><div class="top"><p class="src"><a name="v:pNot" class="def">pNot</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Predicate">Predicate</a> a<a href="src/Control-Monad-Conc-SCT-Tests.html#pNot" class="link">Source</a></p><div class="doc"><p>Invert the result of a predicate.
</p></div></div><div class="top"><p class="src"><a name="v:rForgetful" class="def">rForgetful</a> ::  <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> a -&gt; <a href="Control-Monad-Conc-SCT-Tests.html#t:Result">Result</a> ()<a href="src/Control-Monad-Conc-SCT-Tests.html#rForgetful" class="link">Source</a></p><div class="doc"><p>Throw away the failures information in a Result (useful for
 storing them in a list).
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2.1</p></div></body></html>