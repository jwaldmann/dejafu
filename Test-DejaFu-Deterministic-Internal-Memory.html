<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Test.DejaFu.Deterministic.Internal.Memory</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Test-DejaFu-Deterministic-Internal-Memory.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Test-DejaFu-Deterministic-Internal-Memory.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">dejafu-0.2.0.0: Overloadable primitives for testable, potentially non-deterministic, concurrency.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Test.DejaFu.Deterministic.Internal.Memory</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Manipulating <code>CRef</code>s</a></li><li><a href="#g:2">Manipulating <code>CVar</code>s</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Operations over <code>CRef</code>s and <code>CVar</code>s</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">newtype</span> <a href="#t:WriteBuffer">WriteBuffer</a> r = <a href="#v:WriteBuffer">WriteBuffer</a> {<ul class="subs"><li><a href="#v:buffer">buffer</a> :: <a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-IntMap-Strict.html#t:IntMap">IntMap</a> (<a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-Sequence.html#t:Seq">Seq</a> (<a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:BufferedWrite">BufferedWrite</a> r))</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:BufferedWrite">BufferedWrite</a> r <span class="keyword">where</span><ul class="subs"><li><a href="#v:BufferedWrite">BufferedWrite</a> ::  <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CRef">CRef</a> r a -&gt; a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:BufferedWrite">BufferedWrite</a> r</li></ul></li><li class="src short"><a href="#v:emptyBuffer">emptyBuffer</a> :: <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r</li><li class="src short"><a href="#v:bufferWrite">bufferWrite</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CRef">CRef</a> r a -&gt; a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; n (<a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r)</li><li class="src short"><a href="#v:commitWrite">commitWrite</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; n (<a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r)</li><li class="src short"><a href="#v:readCRef">readCRef</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CRef">CRef</a> r a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; n a</li><li class="src short"><a href="#v:writeImmediate">writeImmediate</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CRef">CRef</a> r a -&gt; a -&gt; n ()</li><li class="src short"><a href="#v:writeBarrier">writeBarrier</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r -&gt; n ()</li><li class="src short"><a href="#v:addCommitThreads">addCommitThreads</a> :: <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s</li><li class="src short"><a href="#v:delCommitThreads">delCommitThreads</a> :: <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s</li><li class="src short"><a href="#v:putIntoCVar">putIntoCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>])</li><li class="src short"><a href="#v:tryPutIntoCVar">tryPutIntoCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; a -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>])</li><li class="src short"><a href="#v:readFromCVar">readFromCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; (a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>])</li><li class="src short"><a href="#v:takeFromCVar">takeFromCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; (a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>])</li><li class="src short"><a href="#v:tryTakeFromCVar">tryTakeFromCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>])</li><li class="src short"><a href="#v:mutCVar">mutCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; a -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>])</li><li class="src short"><a href="#v:seeCVar">seeCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>])</li></ul></div><div id="interface"><h1 id="g:1">Manipulating <code>CRef</code>s</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a name="t:WriteBuffer" class="def">WriteBuffer</a> r <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#WriteBuffer" class="link">Source</a></p><div class="doc"><p>In non-sequentially-consistent memory models, non-synchronised
 writes get buffered.</p><p>In TSO, the keys are <code>ThreadId</code>s. In PSO, the keys are <code>CRefId</code>s.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:WriteBuffer" class="def">WriteBuffer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:buffer" class="def">buffer</a> :: <a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-IntMap-Strict.html#t:IntMap">IntMap</a> (<a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-Sequence.html#t:Seq">Seq</a> (<a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:BufferedWrite">BufferedWrite</a> r))</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:BufferedWrite" class="def">BufferedWrite</a> r <span class="keyword">where</span> <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#BufferedWrite" class="link">Source</a></p><div class="doc"><p>A buffered write is a reference to the variable, and the value to
 write. Universally quantified over the value type so that the only
 thing which can be done with it is to write it to the reference.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:BufferedWrite" class="def">BufferedWrite</a> ::  <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CRef">CRef</a> r a -&gt; a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:BufferedWrite">BufferedWrite</a> r</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a name="v:emptyBuffer" class="def">emptyBuffer</a> :: <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#emptyBuffer" class="link">Source</a></p><div class="doc"><p>An empty write buffer.</p></div></div><div class="top"><p class="src"><a name="v:bufferWrite" class="def">bufferWrite</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CRef">CRef</a> r a -&gt; a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; n (<a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#bufferWrite" class="link">Source</a></p><div class="doc"><p>Add a new write to the end of a buffer.</p></div></div><div class="top"><p class="src"><a name="v:commitWrite" class="def">commitWrite</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; n (<a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#commitWrite" class="link">Source</a></p><div class="doc"><p>Commit the write at the head of a buffer.</p></div></div><div class="top"><p class="src"><a name="v:readCRef" class="def">readCRef</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CRef">CRef</a> r a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; n a <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#readCRef" class="link">Source</a></p><div class="doc"><p>Read from a <code>CRef</code>, returning a newer thread-local non-committed
 write if there is one.</p></div></div><div class="top"><p class="src"><a name="v:writeImmediate" class="def">writeImmediate</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CRef">CRef</a> r a -&gt; a -&gt; n () <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#writeImmediate" class="link">Source</a></p><div class="doc"><p>Write and commit to a <code>CRef</code> immediately, clearing the update
 map.</p></div></div><div class="top"><p class="src"><a name="v:writeBarrier" class="def">writeBarrier</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r -&gt; n () <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#writeBarrier" class="link">Source</a></p><div class="doc"><p>Flush all writes in the buffer.</p></div></div><div class="top"><p class="src"><a name="v:addCommitThreads" class="def">addCommitThreads</a> :: <a href="Test-DejaFu-Deterministic-Internal-Memory.html#t:WriteBuffer">WriteBuffer</a> r -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#addCommitThreads" class="link">Source</a></p><div class="doc"><p>Add phantom threads to the thread list to commit pending writes.</p></div></div><div class="top"><p class="src"><a name="v:delCommitThreads" class="def">delCommitThreads</a> :: <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#delCommitThreads" class="link">Source</a></p><div class="doc"><p>Remove phantom threads.</p></div></div><h1 id="g:2">Manipulating <code>CVar</code>s</h1><div class="top"><p class="src"><a name="v:putIntoCVar" class="def">putIntoCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#putIntoCVar" class="link">Source</a></p><div class="doc"><p>Put into a <code>CVar</code>, blocking if full.</p></div></div><div class="top"><p class="src"><a name="v:tryPutIntoCVar" class="def">tryPutIntoCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; a -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#tryPutIntoCVar" class="link">Source</a></p><div class="doc"><p>Try to put into a <code>CVar</code>, not blocking if full.</p></div></div><div class="top"><p class="src"><a name="v:readFromCVar" class="def">readFromCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; (a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#readFromCVar" class="link">Source</a></p><div class="doc"><p>Read from a <code>CVar</code>, blocking if empty.</p></div></div><div class="top"><p class="src"><a name="v:takeFromCVar" class="def">takeFromCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; (a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#takeFromCVar" class="link">Source</a></p><div class="doc"><p>Take from a <code>CVar</code>, blocking if empty.</p></div></div><div class="top"><p class="src"><a name="v:tryTakeFromCVar" class="def">tryTakeFromCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#tryTakeFromCVar" class="link">Source</a></p><div class="doc"><p>Try to take from a <code>CVar</code>, not blocking if empty.</p></div></div><div class="top"><p class="src"><a name="v:mutCVar" class="def">mutCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; a -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#mutCVar" class="link">Source</a></p><div class="doc"><p>Mutate a <code>CVar</code>, in either a blocking or nonblocking way.</p></div></div><div class="top"><p class="src"><a name="v:seeCVar" class="def">seeCVar</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> n =&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a> r a -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Action">Action</a> n r s) -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Fixed">Fixed</a> n r s -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s -&gt; n (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>, <a href="Test-DejaFu-Deterministic-Internal-Threading.html#t:Threads">Threads</a> n r s, [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]) <a href="src/Test-DejaFu-Deterministic-Internal-Memory.html#seeCVar" class="link">Source</a></p><div class="doc"><p>Read a <code>CVar</code>, in either a blocking or nonblocking
 way.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>