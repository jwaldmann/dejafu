<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Control.Monad.Conc.Fixed.Internal</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Control-Monad-Conc-Fixed-Internal.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Control-Monad-Conc-Fixed-Internal.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">monad-conc-0.0.0.0: Overloadable primitives for potentially non-deterministic concurrency.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Control.Monad.Conc.Fixed.Internal</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Concurrent monads with a fixed scheduler.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">class</span> (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Monad.html#t:Functor">Functor</a> m, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Monad.html#t:Functor">Functor</a> n, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Monad.html#t:Monad">Monad</a> m, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Monad.html#t:Monad">Monad</a> n) =&gt; <a href="#t:Fixed">Fixed</a> m n r a | m -&gt; n, m -&gt; r, m -&gt; a, r -&gt; m, a -&gt; m <span class="keyword">where</span><ul class="subs"><li><a href="#v:newRef">newRef</a> ::  x -&gt; n (r x)</li><li><a href="#v:readRef">readRef</a> ::  r x -&gt; n x</li><li><a href="#v:writeRef">writeRef</a> ::  r x -&gt; x -&gt; n ()</li><li><a href="#v:liftN">liftN</a> ::  n x -&gt; m x</li><li><a href="#v:stopA">stopA</a> :: a</li><li><a href="#v:step">step</a> :: a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li><a href="#v:unC">unC</a> ::  m x -&gt; <a href="https://hackage.haskell.org/package/transformers-0.3.0.0/docs/Control-Monad-Trans-Cont.html#t:Cont">Cont</a> a x</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:ThreadId">ThreadId</a> = <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Scheduler">Scheduler</a> s = s -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>] -&gt; (<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>, s)</li><li class="src short"><span class="keyword">type</span> <a href="#t:Trace">Trace</a> = [(<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>, <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)]</li><li class="src short"><span class="keyword">data</span> <a href="#t:ThreadAction">ThreadAction</a><ul class="subs"><li>= <a href="#v:Fork">Fork</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a></li><li>| <a href="#v:Put">Put</a> [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:BlockedPut">BlockedPut</a></li><li>| <a href="#v:TryPut">TryPut</a> <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Bool.html#t:Bool">Bool</a> [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:Read">Read</a></li><li>| <a href="#v:BlockedRead">BlockedRead</a></li><li>| <a href="#v:Take">Take</a> [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:BlockedTake">BlockedTake</a></li><li>| <a href="#v:TryTake">TryTake</a> <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Bool.html#t:Bool">Bool</a> [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:Lift">Lift</a></li></ul></li><li class="src short"><a href="#v:runFixed">runFixed</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Scheduler">Scheduler</a> s -&gt; s -&gt; m x -&gt; n (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> x)</li><li class="src short"><a href="#v:runFixed-39-">runFixed'</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Scheduler">Scheduler</a> s -&gt; s -&gt; m x -&gt; n (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> x, s, <a href="Control-Monad-Conc-Fixed-Internal.html#t:Trace">Trace</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Block">Block</a><ul class="subs"><li>= <a href="#v:WaitFull">WaitFull</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a></li><li>| <a href="#v:WaitEmpty">WaitEmpty</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:Threads">Threads</a> a = <a href="https://hackage.haskell.org/package/containers-0.5.5.1/docs/Data-Map-Lazy.html#t:Map">Map</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> (a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Bool.html#t:Bool">Bool</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:R">R</a> r a = r (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> a, [<a href="Control-Monad-Conc-Fixed-Internal.html#t:Block">Block</a>])</li><li class="src short"><a href="#v:runThreads">runThreads</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Trace">Trace</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Scheduler">Scheduler</a> s -&gt; s -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; r (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> x) -&gt; n (s, <a href="Control-Monad-Conc-Fixed-Internal.html#t:Trace">Trace</a>)</li><li class="src short"><a href="#v:stepFork">stepFork</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; a -&gt; a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li class="src short"><a href="#v:stepPut">stepPut</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; x -&gt; a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li class="src short"><a href="#v:stepTryPut">stepTryPut</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; x -&gt; (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; a) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li class="src short"><a href="#v:stepGet">stepGet</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (x -&gt; a) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li class="src short"><a href="#v:stepTake">stepTake</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (x -&gt; a) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li class="src short"><a href="#v:stepTryTake">stepTryTake</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> x -&gt; a) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li class="src short"><a href="#v:stepLift">stepLift</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; n a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li class="src short"><a href="#v:stepStop">stepStop</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)</li><li class="src short"><a href="#v:goto">goto</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a</li><li class="src short"><a href="#v:block">block</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Block">Block</a>) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a)</li><li class="src short"><a href="#v:launch">launch</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>)</li><li class="src short"><a href="#v:kill">kill</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a</li><li class="src short"><a href="#v:wake">wake</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Block">Block</a>) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>])</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">class</span> (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Monad.html#t:Functor">Functor</a> m, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Monad.html#t:Functor">Functor</a> n, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Monad.html#t:Monad">Monad</a> m, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Monad.html#t:Monad">Monad</a> n) =&gt; <a name="t:Fixed" class="def">Fixed</a> m n r a | m -&gt; n, m -&gt; r, m -&gt; a, r -&gt; m, a -&gt; m <span class="keyword">where</span> <a href="src/Control-Monad-Conc-Fixed-Internal.html#Fixed" class="link">Source</a></p><div class="doc"><p>A little more abstraction is required to be able to use different
 schedulers. We need to be parametrised by the specific action,
 reference, and underlying monad types used by our implementation.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:newRef" class="def">newRef</a> ::  x -&gt; n (r x) <a href="src/Control-Monad-Conc-Fixed-Internal.html#newRef" class="link">Source</a></p><div class="doc"><p>Create a new reference</p></div><p class="src"><a name="v:readRef" class="def">readRef</a> ::  r x -&gt; n x <a href="src/Control-Monad-Conc-Fixed-Internal.html#readRef" class="link">Source</a></p><div class="doc"><p>Read a reference.</p></div><p class="src"><a name="v:writeRef" class="def">writeRef</a> ::  r x -&gt; x -&gt; n () <a href="src/Control-Monad-Conc-Fixed-Internal.html#writeRef" class="link">Source</a></p><div class="doc"><p>Overwrite the contents of a reference.</p></div><p class="src"><a name="v:liftN" class="def">liftN</a> ::  n x -&gt; m x <a href="src/Control-Monad-Conc-Fixed-Internal.html#liftN" class="link">Source</a></p><div class="doc"><p>Lift an action from the underlying monad</p></div><p class="src"><a name="v:stopA" class="def">stopA</a> :: a <a href="src/Control-Monad-Conc-Fixed-Internal.html#stopA" class="link">Source</a></p><div class="doc"><p>Action to stop</p></div><p class="src"><a name="v:step" class="def">step</a> :: a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#step" class="link">Source</a></p><div class="doc"><p>Evaluate a thread one step, by deconstructing the action and
 calling the appropriate step function from this module.</p></div><p class="src"><a name="v:unC" class="def">unC</a> ::  m x -&gt; <a href="https://hackage.haskell.org/package/transformers-0.3.0.0/docs/Control-Monad-Trans-Cont.html#t:Cont">Cont</a> a x <a href="src/Control-Monad-Conc-Fixed-Internal.html#unC" class="link">Source</a></p><div class="doc"><p>Unpack the continuation-based computation from its wrapping
 type.</p></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ThreadId" class="def">ThreadId</a> = <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Int.html#t:Int">Int</a> <a href="src/Control-Monad-Conc-Fixed-Internal.html#ThreadId" class="link">Source</a></p><div class="doc"><p>Every thread has a unique identitifer. These are implemented as
 integers, but you shouldn't assume they are necessarily contiguous.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Scheduler" class="def">Scheduler</a> s = s -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>] -&gt; (<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>, s) <a href="src/Control-Monad-Conc-Fixed-Internal.html#Scheduler" class="link">Source</a></p><div class="doc"><p>A <code>Scheduler</code> maintains some internal state, <code>s</code>, takes the
 <code><a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a></code> of the last thread scheduled, and the list of runnable
 threads (which will never be empty). It produces a <code><a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a></code> to
 schedule, and a new state.</p><p>Note: In order to prevent deadlock, the <code>Conc</code> runtime will assume
 that a deadlock situation has arisen if the scheduler attempts to
 (a) schedule a blocked thread, or (b) schedule a nonexistant
 thread. In either of those cases, the computation will be halted.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Trace" class="def">Trace</a> = [(<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>, <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>)] <a href="src/Control-Monad-Conc-Fixed-Internal.html#Trace" class="link">Source</a></p><div class="doc"><p>One of the outputs of the runner is a <code>Trace</code>, which is just a
 log of threads and actions they have taken.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ThreadAction" class="def">ThreadAction</a> <a href="src/Control-Monad-Conc-Fixed-Internal.html#ThreadAction" class="link">Source</a></p><div class="doc"><p>All the actions that a thread can perform.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Fork" class="def">Fork</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a></td><td class="doc"><p>Start a new thread.</p></td></tr><tr><td class="src"><a name="v:Put" class="def">Put</a> [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>Put into a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:BlockedPut" class="def">BlockedPut</a></td><td class="doc"><p>Get blocked on a put.</p></td></tr><tr><td class="src"><a name="v:TryPut" class="def">TryPut</a> <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Bool.html#t:Bool">Bool</a> [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>Try to put into a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:Read" class="def">Read</a></td><td class="doc"><p>Read from a <code>CVar</code>.</p></td></tr><tr><td class="src"><a name="v:BlockedRead" class="def">BlockedRead</a></td><td class="doc"><p>Get blocked on a read.</p></td></tr><tr><td class="src"><a name="v:Take" class="def">Take</a> [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>Take from a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:BlockedTake" class="def">BlockedTake</a></td><td class="doc"><p>Get blocked on a take.</p></td></tr><tr><td class="src"><a name="v:TryTake" class="def">TryTake</a> <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Bool.html#t:Bool">Bool</a> [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>try to take from a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:Lift" class="def">Lift</a></td><td class="doc"><p>Lift an action from the underlying monad.</p></td></tr></table></div><div class="subs instances"><p id="control.i:ThreadAction" class="caption collapser" onclick="toggleSection('i:ThreadAction')">Instances</p><div id="section.i:ThreadAction" class="show"><table><tr><td class="src"><a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Text-Show.html#t:Show">Show</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:runFixed" class="def">runFixed</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Scheduler">Scheduler</a> s -&gt; s -&gt; m x -&gt; n (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> x) <a href="src/Control-Monad-Conc-Fixed-Internal.html#runFixed" class="link">Source</a></p><div class="doc"><p>Run a concurrent computation with a given <code><a href="Control-Monad-Conc-Fixed-Internal.html#t:Scheduler">Scheduler</a></code> and initial
 state, returning `Just result` if it terminates, and <code><a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#v:Nothing">Nothing</a></code> if a
 deadlock is detected.</p></div></div><div class="top"><p class="src"><a name="v:runFixed-39-" class="def">runFixed'</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Scheduler">Scheduler</a> s -&gt; s -&gt; m x -&gt; n (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> x, s, <a href="Control-Monad-Conc-Fixed-Internal.html#t:Trace">Trace</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#runFixed%27" class="link">Source</a></p><div class="doc"><p>Variant of <code>runConc</code> which returns the final state of the
 scheduler and an execution trace.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Block" class="def">Block</a> <a href="src/Control-Monad-Conc-Fixed-Internal.html#Block" class="link">Source</a></p><div class="doc"><p>A <code>Block</code> is used to determine what sort of block a thread is
 experiencing.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:WaitFull" class="def">WaitFull</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:WaitEmpty" class="def">WaitEmpty</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Block" class="caption collapser" onclick="toggleSection('i:Block')">Instances</p><div id="section.i:Block" class="show"><table><tr><td class="src"><a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:Block">Block</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Threads" class="def">Threads</a> a = <a href="https://hackage.haskell.org/package/containers-0.5.5.1/docs/Data-Map-Lazy.html#t:Map">Map</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> (a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Bool.html#t:Bool">Bool</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#Threads" class="link">Source</a></p><div class="doc"><p>Threads are represented as a tuple of (next action, is blocked).</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:R" class="def">R</a> r a = r (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> a, [<a href="Control-Monad-Conc-Fixed-Internal.html#t:Block">Block</a>]) <a href="src/Control-Monad-Conc-Fixed-Internal.html#R" class="link">Source</a></p><div class="doc"><p>CVars are represented as a reference containing a maybe value,
 and a list of things blocked on it.</p></div></div><div class="top"><p class="src"><a name="v:runThreads" class="def">runThreads</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Trace">Trace</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Scheduler">Scheduler</a> s -&gt; s -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; r (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> x) -&gt; n (s, <a href="Control-Monad-Conc-Fixed-Internal.html#t:Trace">Trace</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#runThreads" class="link">Source</a></p><div class="doc"><p>Run a collection of threads, until there are no threads left.</p><p>A thread is represented as a tuple of (next action, is blocked).</p><p>Note: this returns the trace in reverse order, because it's more
 efficient to prepend to a list than append. As this function isn't
 exposed to users of the library, this is just an internal gotcha to
 watch out for.</p></div></div><div class="top"><p class="src"><a name="v:stepFork" class="def">stepFork</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; a -&gt; a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#stepFork" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:stepPut" class="def">stepPut</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; x -&gt; a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#stepPut" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:stepTryPut" class="def">stepTryPut</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; x -&gt; (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; a) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#stepTryPut" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:stepGet" class="def">stepGet</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (x -&gt; a) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#stepGet" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:stepTake" class="def">stepTake</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (x -&gt; a) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#stepTake" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:stepTryTake" class="def">stepTryTake</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (<a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> x -&gt; a) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#stepTryTake" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:stepLift" class="def">stepLift</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; n a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#stepLift" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:stepStop" class="def">stepStop</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadAction">ThreadAction</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#stepStop" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:goto" class="def">goto</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a <a href="src/Control-Monad-Conc-Fixed-Internal.html#goto" class="link">Source</a></p><div class="doc"><p>Replace the <code>Action</code> of a thread.</p></div></div><div class="top"><p class="src"><a name="v:block" class="def">block</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Block">Block</a>) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a) <a href="src/Control-Monad-Conc-Fixed-Internal.html#block" class="link">Source</a></p><div class="doc"><p>Block a thread on a <code>CVar</code>.</p></div></div><div class="top"><p class="src"><a name="v:launch" class="def">launch</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>) <a href="src/Control-Monad-Conc-Fixed-Internal.html#launch" class="link">Source</a></p><div class="doc"><p>Start a thread with the next free ID.</p></div></div><div class="top"><p class="src"><a name="v:kill" class="def">kill</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a <a href="src/Control-Monad-Conc-Fixed-Internal.html#kill" class="link">Source</a></p><div class="doc"><p>Kill a thread.</p></div></div><div class="top"><p class="src"><a name="v:wake" class="def">wake</a> :: <a href="Control-Monad-Conc-Fixed-Internal.html#t:Fixed">Fixed</a> m n r a =&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:R">R</a> r x -&gt; (<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a> -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Block">Block</a>) -&gt; <a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a -&gt; n (<a href="Control-Monad-Conc-Fixed-Internal.html#t:Threads">Threads</a> a, [<a href="Control-Monad-Conc-Fixed-Internal.html#t:ThreadId">ThreadId</a>]) <a href="src/Control-Monad-Conc-Fixed-Internal.html#wake" class="link">Source</a></p><div class="doc"><p>Wake every thread blocked on a <code>CVar</code> read/write.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.14.3</p></div></body></html>