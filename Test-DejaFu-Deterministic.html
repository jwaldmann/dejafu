<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Test.DejaFu.Deterministic</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Test-DejaFu-Deterministic.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Test-DejaFu-Deterministic.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">dejafu-0.2.0.0: Overloadable primitives for testable, potentially non-deterministic, concurrency.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Test.DejaFu.Deterministic</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">The <code>Conc</code> Monad</a></li><li><a href="#g:2">Execution traces</a></li><li><a href="#g:3">Scheduling</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Deterministic traced execution of concurrent computations which
 don't do <code>IO</code>.</p><p>This works by executing the computation on a single thread, calling
 out to the supplied scheduler after each step to determine which
 thread runs next.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Conc">Conc</a> t a</li><li class="src short"><span class="keyword">data</span> <a href="#t:Failure">Failure</a><ul class="subs"><li>= <a href="#v:InternalError">InternalError</a></li><li>| <a href="#v:Deadlock">Deadlock</a></li><li>| <a href="#v:STMDeadlock">STMDeadlock</a></li><li>| <a href="#v:UncaughtException">UncaughtException</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:MemType">MemType</a><ul class="subs"><li>= <a href="#v:SequentialConsistency">SequentialConsistency</a></li><li>| <a href="#v:TotalStoreOrder">TotalStoreOrder</a></li><li>| <a href="#v:PartialStoreOrder">PartialStoreOrder</a></li></ul></li><li class="src short"><a href="#v:runConc">runConc</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Scheduler">Scheduler</a> s -&gt; s -&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t a) -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a> a, s, <a href="Test-DejaFu-Deterministic.html#t:Trace">Trace</a>)</li><li class="src short"><a href="#v:runConc-39-">runConc'</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Scheduler">Scheduler</a> s -&gt; <a href="Test-DejaFu-Deterministic.html#t:MemType">MemType</a> -&gt; s -&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t a) -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a> a, s, <a href="Test-DejaFu-Deterministic.html#t:Trace-39-">Trace'</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:Trace">Trace</a> = [(<a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a>, [(<a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic.html#t:Lookahead">Lookahead</a>)], <a href="Test-DejaFu-Deterministic.html#t:ThreadAction">ThreadAction</a>)]</li><li class="src short"><span class="keyword">type</span> <a href="#t:Trace-39-">Trace'</a> = [(<a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a>, [(<a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a>, <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> <a href="Test-DejaFu-Deterministic.html#t:Lookahead">Lookahead</a>)], <a href="Test-DejaFu-Deterministic.html#t:ThreadAction">ThreadAction</a>)]</li><li class="src short"><span class="keyword">data</span> <a href="#t:Decision">Decision</a><ul class="subs"><li>= <a href="#v:Start">Start</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li>| <a href="#v:Continue">Continue</a></li><li>| <a href="#v:SwitchTo">SwitchTo</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li>| <a href="#v:Commit">Commit</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:ThreadAction">ThreadAction</a><ul class="subs"><li>= <a href="#v:Fork">Fork</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li>| <a href="#v:MyThreadId">MyThreadId</a></li><li>| <a href="#v:Yield">Yield</a></li><li>| <a href="#v:New">New</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:Put">Put</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:BlockedPut">BlockedPut</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:TryPut">TryPut</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:Read">Read</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:BlockedRead">BlockedRead</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:Take">Take</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:BlockedTake">BlockedTake</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:TryTake">TryTake</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:NewRef">NewRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:ReadRef">ReadRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:ModRef">ModRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:WriteRef">WriteRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:CommitRef">CommitRef</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:STM">STM</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</li><li>| <a href="#v:FreshSTM">FreshSTM</a></li><li>| <a href="#v:BlockedSTM">BlockedSTM</a></li><li>| <a href="#v:Catching">Catching</a></li><li>| <a href="#v:PopCatching">PopCatching</a></li><li>| <a href="#v:Throw">Throw</a></li><li>| <a href="#v:ThrowTo">ThrowTo</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li>| <a href="#v:BlockedThrowTo">BlockedThrowTo</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li>| <a href="#v:Killed">Killed</a></li><li>| <a href="#v:SetMasking">SetMasking</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></li><li>| <a href="#v:ResetMasking">ResetMasking</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></li><li>| <a href="#v:Lift">Lift</a></li><li>| <a href="#v:KnowsAbout">KnowsAbout</a></li><li>| <a href="#v:Forgets">Forgets</a></li><li>| <a href="#v:AllKnown">AllKnown</a></li><li>| <a href="#v:Stop">Stop</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Lookahead">Lookahead</a><ul class="subs"><li>= <a href="#v:WillFork">WillFork</a></li><li>| <a href="#v:WillMyThreadId">WillMyThreadId</a></li><li>| <a href="#v:WillYield">WillYield</a></li><li>| <a href="#v:WillNew">WillNew</a></li><li>| <a href="#v:WillPut">WillPut</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:WillTryPut">WillTryPut</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:WillRead">WillRead</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:WillTake">WillTake</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:WillTryTake">WillTryTake</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></li><li>| <a href="#v:WillNewRef">WillNewRef</a></li><li>| <a href="#v:WillReadRef">WillReadRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:WillModRef">WillModRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:WillWriteRef">WillWriteRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:WillCommitRef">WillCommitRef</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></li><li>| <a href="#v:WillSTM">WillSTM</a></li><li>| <a href="#v:WillCatching">WillCatching</a></li><li>| <a href="#v:WillPopCatching">WillPopCatching</a></li><li>| <a href="#v:WillThrow">WillThrow</a></li><li>| <a href="#v:WillThrowTo">WillThrowTo</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li>| <a href="#v:WillSetMasking">WillSetMasking</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></li><li>| <a href="#v:WillResetMasking">WillResetMasking</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></li><li>| <a href="#v:WillLift">WillLift</a></li><li>| <a href="#v:WillKnowsAbout">WillKnowsAbout</a></li><li>| <a href="#v:WillForgets">WillForgets</a></li><li>| <a href="#v:WillAllKnown">WillAllKnown</a></li><li>| <a href="#v:WillStop">WillStop</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:CVarId">CVarId</a> = <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:CRefId">CRefId</a> = <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:MaskingState">MaskingState</a> :: *<ul class="subs"><li>= <a href="#v:Unmasked">Unmasked</a></li><li>| <a href="#v:MaskedInterruptible">MaskedInterruptible</a></li><li>| <a href="#v:MaskedUninterruptible">MaskedUninterruptible</a></li></ul></li><li class="src short"><a href="#v:toTrace">toTrace</a> :: <a href="Test-DejaFu-Deterministic.html#t:Trace-39-">Trace'</a> -&gt; <a href="Test-DejaFu-Deterministic.html#t:Trace">Trace</a></li><li class="src short"><a href="#v:showTrace">showTrace</a> :: <a href="Test-DejaFu-Deterministic.html#t:Trace">Trace</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:showFail">showFail</a> :: <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-String.html#t:String">String</a></li><li class="src short">module <a href="Test-DejaFu-Deterministic-Schedule.html">Test.DejaFu.Deterministic.Schedule</a></li></ul></div><div id="interface"><h1 id="g:1">The <code>Conc</code> Monad</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Conc" class="def">Conc</a> t a <a href="src/Test-DejaFu-Deterministic.html#Conc" class="link">Source</a></p><div class="doc"><p>The <code>Conc</code> monad itself. This uses the same
 universally-quantified indexing state trick as used by <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad-ST.html#t:ST">ST</a></code> and
 <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-STRef.html#t:STRef">STRef</a></code>s to prevent mutable references from leaking out of the
 monad.</p></div><div class="subs instances"><p id="control.i:Conc" class="caption collapser" onclick="toggleSection('i:Conc')">Instances</p><div id="section.i:Conc" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#t:Monad">Monad</a> (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-62" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Functor.html#t:Functor">Functor</a> (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-62" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Applicative.html#t:Applicative">Applicative</a> (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-62" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">MonadThrow (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-70" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">MonadMask (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-73" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">MonadCatch (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-67" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Conc-Class.html#t:MonadConc">MonadConc</a> (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-77" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Control-Monad-Conc-Class.html#t:STMLike">STMLike</a> (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t) = <a href="Test-DejaFu-STM.html#t:STMLike">STMLike</a> t (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad-ST.html#t:ST">ST</a> t) (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-STRef.html#t:STRef">STRef</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-80" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Control-Monad-Conc-Class.html#t:CVar">CVar</a> (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-78" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Control-Monad-Conc-Class.html#t:CRef">CRef</a> (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t)</span> <a href="src/Test-DejaFu-Deterministic.html#line-79" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Control-Monad-Conc-Class.html#t:ThreadId">ThreadId</a> (<a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t) = <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></span> <a href="src/Test-DejaFu-Deterministic.html#line-81" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Failure" class="def">Failure</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#Failure" class="link">Source</a></p><div class="doc"><p>An indication of how a concurrent computation failed.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:InternalError" class="def">InternalError</a></td><td class="doc"><p>Will be raised if the scheduler does something bad. This should
 never arise unless you write your own, faulty, scheduler! If it
 does, please file a bug report.</p></td></tr><tr><td class="src"><a name="v:Deadlock" class="def">Deadlock</a></td><td class="doc"><p>The computation became blocked indefinitely on <code>CVar</code>s.</p></td></tr><tr><td class="src"><a name="v:STMDeadlock" class="def">STMDeadlock</a></td><td class="doc"><p>The computation became blocked indefinitely on <code>CTVar</code>s.</p></td></tr><tr><td class="src"><a name="v:UncaughtException" class="def">UncaughtException</a></td><td class="doc"><p>An uncaught exception bubbled to the top of the computation.</p></td></tr></table></div><div class="subs instances"><p id="control.i:Failure" class="caption collapser" onclick="toggleSection('i:Failure')">Instances</p><div id="section.i:Failure" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-466" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Show.html#t:Show">Show</a> <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-466" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/deepseq-1.4.1.1/docs/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-468" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:MemType" class="def">MemType</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#MemType" class="link">Source</a></p><div class="doc"><p>The memory model to use for non-synchronised <code>CRef</code> operations.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:SequentialConsistency" class="def">SequentialConsistency</a></td><td class="doc"><p>The most intuitive model: a program behaves as a simple
 interleaving of the actions in different threads. When a <code>CRef</code>
 is written to, that write is immediately visible to all threads.</p></td></tr><tr><td class="src"><a name="v:TotalStoreOrder" class="def">TotalStoreOrder</a></td><td class="doc"><p>Each thread has a write buffer. A thread sees its writes
 immediately, but other threads will only see writes when they are
 committed, which may happen later. Writes are committed in the
 same order that they are created.</p></td></tr><tr><td class="src"><a name="v:PartialStoreOrder" class="def">PartialStoreOrder</a></td><td class="doc"><p>Each <code>CRef</code> has a write buffer. A thread sees its writes
 immediately, but other threads will only see writes when they are
 committed, which may happen later. Writes to different <code>CRef</code>s
 are not necessarily committed in the same order that they are
 created.</p></td></tr></table></div><div class="subs instances"><p id="control.i:MemType" class="caption collapser" onclick="toggleSection('i:MemType')">Instances</p><div id="section.i:MemType" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Test-DejaFu-Deterministic.html#t:MemType">MemType</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-498" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Read.html#t:Read">Read</a> <a href="Test-DejaFu-Deterministic.html#t:MemType">MemType</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-498" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Show.html#t:Show">Show</a> <a href="Test-DejaFu-Deterministic.html#t:MemType">MemType</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-498" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/deepseq-1.4.1.1/docs/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Test-DejaFu-Deterministic.html#t:MemType">MemType</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-500" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:runConc" class="def">runConc</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Scheduler">Scheduler</a> s -&gt; s -&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t a) -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a> a, s, <a href="Test-DejaFu-Deterministic.html#t:Trace">Trace</a>) <a href="src/Test-DejaFu-Deterministic.html#runConc" class="link">Source</a></p><div class="doc"><p>Run a concurrent computation with a given <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Scheduler">Scheduler</a></code> and initial
 state, returning a failure reason on error. Also returned is the
 final state of the scheduler, and an execution trace.</p><p>Note how the <code>t</code> in <code><a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a></code> is universally quantified, what this
 means in practice is that you can't do something like this:</p><pre>runConc roundRobinSched () newEmptyCVar</pre><p>So mutable references cannot leak out of the <code><a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a></code> computation. If
 this is making your head hurt, check out the &quot;How <code>runST</code> works&quot;
 section of
 <a href="https://ocharles.org.uk/blog/guest-posts/2014-12-18-rank-n-types.html">https://ocharles.org.uk/blog/guest-posts/2014-12-18-rank-n-types.html</a></p><p>This uses the <code><a href="Test-DejaFu-Deterministic.html#v:SequentialConsistency">SequentialConsistency</a></code> memory model.</p></div></div><div class="top"><p class="src"><a name="v:runConc-39-" class="def">runConc'</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Scheduler">Scheduler</a> s -&gt; <a href="Test-DejaFu-Deterministic.html#t:MemType">MemType</a> -&gt; s -&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:Conc">Conc</a> t a) -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a> a, s, <a href="Test-DejaFu-Deterministic.html#t:Trace-39-">Trace'</a>) <a href="src/Test-DejaFu-Deterministic.html#runConc%27" class="link">Source</a></p><div class="doc"><p>Variant of <code><a href="Test-DejaFu-Deterministic.html#v:runConc">runConc</a></code> which produces a <code><a href="Test-DejaFu-Deterministic.html#t:Trace-39-">Trace'</a></code>.</p></div></div><h1 id="g:2">Execution traces</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Trace" class="def">Trace</a> = [(<a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a>, [(<a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic.html#t:Lookahead">Lookahead</a>)], <a href="Test-DejaFu-Deterministic.html#t:ThreadAction">ThreadAction</a>)] <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#Trace" class="link">Source</a></p><div class="doc"><p>One of the outputs of the runner is a <code>Trace</code>, which is a log of
 decisions made, alternative decisions (including what action would
 have been performed had that decision been taken), and the action a
 thread took in its step.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Trace-39-" class="def">Trace'</a> = [(<a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a>, [(<a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a>, <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> <a href="Test-DejaFu-Deterministic.html#t:Lookahead">Lookahead</a>)], <a href="Test-DejaFu-Deterministic.html#t:ThreadAction">ThreadAction</a>)] <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#Trace%27" class="link">Source</a></p><div class="doc"><p>Like a <code><a href="Test-DejaFu-Deterministic.html#t:Trace">Trace</a></code>, but gives more lookahead (where possible) for
 alternative decisions.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Decision" class="def">Decision</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#Decision" class="link">Source</a></p><div class="doc"><p>Scheduling decisions are based on the state of the running
 program, and so we can capture some of that state in recording what
 specific decision we made.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Start" class="def">Start</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></td><td class="doc"><p>Start a new thread, because the last was blocked (or it's the
 start of computation).</p></td></tr><tr><td class="src"><a name="v:Continue" class="def">Continue</a></td><td class="doc"><p>Continue running the last thread for another step.</p></td></tr><tr><td class="src"><a name="v:SwitchTo" class="def">SwitchTo</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></td><td class="doc"><p>Pre-empt the running thread, and switch to another.</p></td></tr><tr><td class="src"><a name="v:Commit" class="def">Commit</a></td><td class="doc"><p>Commit a <code>CRef</code> write action so that every thread can see the
 result.</p></td></tr></table></div><div class="subs instances"><p id="control.i:Decision" class="caption collapser" onclick="toggleSection('i:Decision')">Instances</p><div id="section.i:Decision" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-167" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Show.html#t:Show">Show</a> <a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-167" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/deepseq-1.4.1.1/docs/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Test-DejaFu-Deterministic.html#t:Decision">Decision</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-169" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ThreadAction" class="def">ThreadAction</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#ThreadAction" class="link">Source</a></p><div class="doc"><p>All the actions that a thread can perform.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Fork" class="def">Fork</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></td><td class="doc"><p>Start a new thread.</p></td></tr><tr><td class="src"><a name="v:MyThreadId" class="def">MyThreadId</a></td><td class="doc"><p>Get the <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></code> of the current thread.</p></td></tr><tr><td class="src"><a name="v:Yield" class="def">Yield</a></td><td class="doc"><p>Yield the current thread.</p></td></tr><tr><td class="src"><a name="v:New" class="def">New</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Create a new <code>CVar</code>.</p></td></tr><tr><td class="src"><a name="v:Put" class="def">Put</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>Put into a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:BlockedPut" class="def">BlockedPut</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Get blocked on a put.</p></td></tr><tr><td class="src"><a name="v:TryPut" class="def">TryPut</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>Try to put into a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:Read" class="def">Read</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Read from a <code>CVar</code>.</p></td></tr><tr><td class="src"><a name="v:BlockedRead" class="def">BlockedRead</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Get blocked on a read.</p></td></tr><tr><td class="src"><a name="v:Take" class="def">Take</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>Take from a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:BlockedTake" class="def">BlockedTake</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Get blocked on a take.</p></td></tr><tr><td class="src"><a name="v:TryTake" class="def">TryTake</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>Try to take from a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:NewRef" class="def">NewRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Create a new <code>CRef</code>.</p></td></tr><tr><td class="src"><a name="v:ReadRef" class="def">ReadRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Read from a <code>CRef</code>.</p></td></tr><tr><td class="src"><a name="v:ModRef" class="def">ModRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Modify a <code>CRef</code>.</p></td></tr><tr><td class="src"><a name="v:WriteRef" class="def">WriteRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Write to a <code>CRef</code> without synchronising.</p></td></tr><tr><td class="src"><a name="v:CommitRef" class="def">CommitRef</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Commit the last write to the given <code>CRef</code> by the given thread,
 so that all threads can see the updated value.</p></td></tr><tr><td class="src"><a name="v:STM" class="def">STM</a> [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>]</td><td class="doc"><p>An STM transaction was executed, possibly waking up some
 threads.</p></td></tr><tr><td class="src"><a name="v:FreshSTM" class="def">FreshSTM</a></td><td class="doc"><p>An STM transaction was executed, and all it did was create and
 write to new <code>CTVar</code>s, no existing <code>CTVar</code>s were touched.</p></td></tr><tr><td class="src"><a name="v:BlockedSTM" class="def">BlockedSTM</a></td><td class="doc"><p>Got blocked in an STM transaction.</p></td></tr><tr><td class="src"><a name="v:Catching" class="def">Catching</a></td><td class="doc"><p>Register a new exception handler</p></td></tr><tr><td class="src"><a name="v:PopCatching" class="def">PopCatching</a></td><td class="doc"><p>Pop the innermost exception handler from the stack.</p></td></tr><tr><td class="src"><a name="v:Throw" class="def">Throw</a></td><td class="doc"><p>Throw an exception.</p></td></tr><tr><td class="src"><a name="v:ThrowTo" class="def">ThrowTo</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></td><td class="doc"><p>Throw an exception to a thread.</p></td></tr><tr><td class="src"><a name="v:BlockedThrowTo" class="def">BlockedThrowTo</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></td><td class="doc"><p>Get blocked on a <code>throwTo</code>.</p></td></tr><tr><td class="src"><a name="v:Killed" class="def">Killed</a></td><td class="doc"><p>Killed by an uncaught exception.</p></td></tr><tr><td class="src"><a name="v:SetMasking" class="def">SetMasking</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></td><td class="doc"><p>Set the masking state. If <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#v:True">True</a></code>, this is being used to set the
 masking state to the original state in the argument passed to a
 <code>mask</code>ed function.</p></td></tr><tr><td class="src"><a name="v:ResetMasking" class="def">ResetMasking</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></td><td class="doc"><p>Return to an earlier masking state.  If <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#v:True">True</a></code>, this is being
 used to return to the state of the masked block in the argument
 passed to a <code>mask</code>ed function.</p></td></tr><tr><td class="src"><a name="v:Lift" class="def">Lift</a></td><td class="doc"><p>Lift an action from the underlying monad. Note that the
 penultimate action in a trace will always be a <code>Lift</code>, this is an
 artefact of how the runner works.</p></td></tr><tr><td class="src"><a name="v:KnowsAbout" class="def">KnowsAbout</a></td><td class="doc"><p>A <code>_concKnowsAbout</code> annotation was processed.</p></td></tr><tr><td class="src"><a name="v:Forgets" class="def">Forgets</a></td><td class="doc"><p>A <code>_concForgets</code> annotation was processed.</p></td></tr><tr><td class="src"><a name="v:AllKnown" class="def">AllKnown</a></td><td class="doc"><p>A <code>_concALlKnown</code> annotation was processed.</p></td></tr><tr><td class="src"><a name="v:Stop" class="def">Stop</a></td><td class="doc"><p>Cease execution and terminate.</p></td></tr></table></div><div class="subs instances"><p id="control.i:ThreadAction" class="caption collapser" onclick="toggleSection('i:ThreadAction')">Instances</p><div id="section.i:ThreadAction" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Test-DejaFu-Deterministic.html#t:ThreadAction">ThreadAction</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-251" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Show.html#t:Show">Show</a> <a href="Test-DejaFu-Deterministic.html#t:ThreadAction">ThreadAction</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-251" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/deepseq-1.4.1.1/docs/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Test-DejaFu-Deterministic.html#t:ThreadAction">ThreadAction</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-253" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Lookahead" class="def">Lookahead</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#Lookahead" class="link">Source</a></p><div class="doc"><p>A one-step look-ahead at what a thread will do next.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:WillFork" class="def">WillFork</a></td><td class="doc"><p>Will start a new thread.</p></td></tr><tr><td class="src"><a name="v:WillMyThreadId" class="def">WillMyThreadId</a></td><td class="doc"><p>Will get the <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></code>.</p></td></tr><tr><td class="src"><a name="v:WillYield" class="def">WillYield</a></td><td class="doc"><p>Will yield the current thread.</p></td></tr><tr><td class="src"><a name="v:WillNew" class="def">WillNew</a></td><td class="doc"><p>Will create a new <code>CVar</code>.</p></td></tr><tr><td class="src"><a name="v:WillPut" class="def">WillPut</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Will put into a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:WillTryPut" class="def">WillTryPut</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Will try to put into a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:WillRead" class="def">WillRead</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Will read from a <code>CVar</code>.</p></td></tr><tr><td class="src"><a name="v:WillTake" class="def">WillTake</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Will take from a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:WillTryTake" class="def">WillTryTake</a> <a href="Test-DejaFu-Deterministic.html#t:CVarId">CVarId</a></td><td class="doc"><p>Will try to take from a <code>CVar</code>, possibly waking up some threads.</p></td></tr><tr><td class="src"><a name="v:WillNewRef" class="def">WillNewRef</a></td><td class="doc"><p>Will create a new <code>CRef</code>.</p></td></tr><tr><td class="src"><a name="v:WillReadRef" class="def">WillReadRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Will read from a <code>CRef</code>.</p></td></tr><tr><td class="src"><a name="v:WillModRef" class="def">WillModRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Will modify a <code>CRef</code>.</p></td></tr><tr><td class="src"><a name="v:WillWriteRef" class="def">WillWriteRef</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Will write to a <code>CRef</code> without synchronising.</p></td></tr><tr><td class="src"><a name="v:WillCommitRef" class="def">WillCommitRef</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> <a href="Test-DejaFu-Deterministic.html#t:CRefId">CRefId</a></td><td class="doc"><p>Will commit the last write by the given thread to the <code>CRef</code>.</p></td></tr><tr><td class="src"><a name="v:WillSTM" class="def">WillSTM</a></td><td class="doc"><p>Will execute an STM transaction, possibly waking up some
 threads.</p></td></tr><tr><td class="src"><a name="v:WillCatching" class="def">WillCatching</a></td><td class="doc"><p>Will register a new exception handler</p></td></tr><tr><td class="src"><a name="v:WillPopCatching" class="def">WillPopCatching</a></td><td class="doc"><p>Will pop the innermost exception handler from the stack.</p></td></tr><tr><td class="src"><a name="v:WillThrow" class="def">WillThrow</a></td><td class="doc"><p>Will throw an exception.</p></td></tr><tr><td class="src"><a name="v:WillThrowTo" class="def">WillThrowTo</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></td><td class="doc"><p>Will throw an exception to a thread.</p></td></tr><tr><td class="src"><a name="v:WillSetMasking" class="def">WillSetMasking</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></td><td class="doc"><p>Will set the masking state. If <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#v:True">True</a></code>, this is being used to
 set the masking state to the original state in the argument
 passed to a <code>mask</code>ed function.</p></td></tr><tr><td class="src"><a name="v:WillResetMasking" class="def">WillResetMasking</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></td><td class="doc"><p>Will return to an earlier masking state.  If <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#v:True">True</a></code>, this is
 being used to return to the state of the masked block in the
 argument passed to a <code>mask</code>ed function.</p></td></tr><tr><td class="src"><a name="v:WillLift" class="def">WillLift</a></td><td class="doc"><p>Will lift an action from the underlying monad. Note that the
 penultimate action in a trace will always be a <code>Lift</code>, this is an
 artefact of how the runner works.</p></td></tr><tr><td class="src"><a name="v:WillKnowsAbout" class="def">WillKnowsAbout</a></td><td class="doc"><p>Will process a <code>_concKnowsAbout</code> annotation.</p></td></tr><tr><td class="src"><a name="v:WillForgets" class="def">WillForgets</a></td><td class="doc"><p>Will process a <code>_concForgets</code> annotation.</p></td></tr><tr><td class="src"><a name="v:WillAllKnown" class="def">WillAllKnown</a></td><td class="doc"><p>Will process a <code>_concALlKnown</code> annotation.</p></td></tr><tr><td class="src"><a name="v:WillStop" class="def">WillStop</a></td><td class="doc"><p>Will cease execution and terminate.</p></td></tr></table></div><div class="subs instances"><p id="control.i:Lookahead" class="caption collapser" onclick="toggleSection('i:Lookahead')">Instances</p><div id="section.i:Lookahead" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Test-DejaFu-Deterministic.html#t:Lookahead">Lookahead</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-337" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Show.html#t:Show">Show</a> <a href="Test-DejaFu-Deterministic.html#t:Lookahead">Lookahead</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-337" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/deepseq-1.4.1.1/docs/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Test-DejaFu-Deterministic.html#t:Lookahead">Lookahead</a></span> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#line-339" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:CVarId" class="def">CVarId</a> = <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#CVarId" class="link">Source</a></p><div class="doc"><p>Every <code>CVar</code> has a unique identifier.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:CRefId" class="def">CRefId</a> = <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#CRefId" class="link">Source</a></p><div class="doc"><p>Every <code>CRef</code> has a unique identifier.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:MaskingState" class="def">MaskingState</a> :: *</p><div class="doc"><p>Describes the behaviour of a thread when an asynchronous
 exception is received.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Unmasked" class="def">Unmasked</a></td><td class="doc"><p>asynchronous exceptions are unmasked (the normal state)</p></td></tr><tr><td class="src"><a name="v:MaskedInterruptible" class="def">MaskedInterruptible</a></td><td class="doc"><p>the state during <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception-Base.html#v:mask">mask</a></code>: asynchronous exceptions are masked, but blocking operations may still be interrupted</p></td></tr><tr><td class="src"><a name="v:MaskedUninterruptible" class="def">MaskedUninterruptible</a></td><td class="doc"><p>the state during <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception-Base.html#v:uninterruptibleMask">uninterruptibleMask</a></code>: asynchronous exceptions are masked, and blocking operations may not be interrupted</p></td></tr></table></div><div class="subs instances"><p id="control.i:MaskingState" class="caption collapser" onclick="toggleSection('i:MaskingState')">Instances</p><div id="section.i:MaskingState" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Show.html#t:Show">Show</a> <a href="Test-DejaFu-Deterministic.html#t:MaskingState">MaskingState</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:toTrace" class="def">toTrace</a> :: <a href="Test-DejaFu-Deterministic.html#t:Trace-39-">Trace'</a> -&gt; <a href="Test-DejaFu-Deterministic.html#t:Trace">Trace</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#toTrace" class="link">Source</a></p><div class="doc"><p>Throw away information from a <code><a href="Test-DejaFu-Deterministic.html#t:Trace-39-">Trace'</a></code> to get just a <code><a href="Test-DejaFu-Deterministic.html#t:Trace">Trace</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:showTrace" class="def">showTrace</a> :: <a href="Test-DejaFu-Deterministic.html#t:Trace">Trace</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-String.html#t:String">String</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#showTrace" class="link">Source</a></p><div class="doc"><p>Pretty-print a trace.</p></div></div><div class="top"><p class="src"><a name="v:showFail" class="def">showFail</a> :: <a href="Test-DejaFu-Deterministic.html#t:Failure">Failure</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-String.html#t:String">String</a> <a href="src/Test-DejaFu-Deterministic-Internal-Common.html#showFail" class="link">Source</a></p><div class="doc"><p>Pretty-print a failure</p></div></div><h1 id="g:3">Scheduling</h1><div class="top"><p class="src">module <a href="Test-DejaFu-Deterministic-Schedule.html">Test.DejaFu.Deterministic.Schedule</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>