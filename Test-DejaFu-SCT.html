<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Test.DejaFu.SCT</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Test-DejaFu-SCT.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Test-DejaFu-SCT.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">dejafu-0.2.0.0: Overloadable primitives for testable, potentially non-deterministic, concurrency.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Test.DejaFu.SCT</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Bounded Partial-order Reduction</a></li><li><a href="#g:2">Pre-emption and Fair Bounding</a></li><li><a href="#g:3">Utilities</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Systematic testing for concurrent computations.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:BacktrackStep">BacktrackStep</a> = <a href="#v:BacktrackStep">BacktrackStep</a> {<ul class="subs"><li><a href="#v:_threadid">_threadid</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li><a href="#v:_decision">_decision</a> :: (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)</li><li><a href="#v:_runnable">_runnable</a> :: <a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-IntMap-Strict.html#t:IntMap">IntMap</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a></li><li><a href="#v:_backtrack">_backtrack</a> :: <a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-IntMap-Strict.html#t:IntMap">IntMap</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a></li></ul>}</li><li class="src short"><a href="#v:sctBounded">sctBounded</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; ([(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; ([<a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a>] -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; [<a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a>]) -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>) -&gt; <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>) -&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:ConcST">ConcST</a> t a) -&gt; [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</li><li class="src short"><a href="#v:sctBoundedIO">sctBoundedIO</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; ([(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; ([<a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a>] -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; [<a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a>]) -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>) -&gt; <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>) -&gt; <a href="Test-DejaFu-Deterministic.html#t:ConcIO">ConcIO</a> a -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a> [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</li><li class="src short"><a href="#v:sctPreBound">sctPreBound</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:ConcST">ConcST</a> t a) -&gt; [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</li><li class="src short"><a href="#v:sctPreBoundIO">sctPreBoundIO</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic.html#t:ConcIO">ConcIO</a> a -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a> [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</li><li class="src short"><a href="#v:sctFairBound">sctFairBound</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:ConcST">ConcST</a> t a) -&gt; [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</li><li class="src short"><a href="#v:sctFairBoundIO">sctFairBoundIO</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic.html#t:ConcIO">ConcIO</a> a -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a> [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</li><li class="src short"><a href="#v:sctPFBound">sctPFBound</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:ConcST">ConcST</a> t a) -&gt; [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</li><li class="src short"><a href="#v:sctPFBoundIO">sctPFBoundIO</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic.html#t:ConcIO">ConcIO</a> a -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a> [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</li><li class="src short"><a href="#v:tidOf">tidOf</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li class="src short"><a href="#v:decisionOf">decisionOf</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-Set.html#t:Set">Set</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a></li><li class="src short"><a href="#v:activeTid">activeTid</a> :: [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>] -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></li><li class="src short"><a href="#v:preEmpCount">preEmpCount</a> :: [(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:preEmpCount-39-">preEmpCount'</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:yieldCount">yieldCount</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; [(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:maxYieldCountDiff">maxYieldCountDiff</a> :: [(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:initialCVState">initialCVState</a> :: <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a></li><li class="src short"><a href="#v:updateCVState">updateCVState</a> :: <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a> -&gt; <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a></li><li class="src short"><a href="#v:willBlock">willBlock</a> :: <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:willBlockSafely">willBlockSafely</a> :: <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a> -&gt; [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>] -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a></li></ul></div><div id="interface"><h1 id="g:1">Bounded Partial-order Reduction</h1><div class="doc"><p>We can characterise the state of a concurrent computation by
 considering the ordering of dependent events. This is a partial
 order: independent events can be performed in any order without
 affecting the result, and so are <em>not</em> ordered.</p><p>Partial-order reduction is a technique for computing these
 partial orders, and only testing one total order for each partial
 order. This cuts down the amount of work to be done
 significantly. <em>Bounded</em> partial-order reduction is a further
 optimisation, which only considers schedules within some bound.</p><p>This module provides both a generic function for BPOR, and also a
 pre-emption bounding BPOR runner, which is used by the
 <a href="Test-DejaFu.html">Test.DejaFu</a> module.</p><p>See <em>Bounded partial-order reduction</em>, K. Coons, M. Musuvathi,
 K. McKinley for more details.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:BacktrackStep" class="def">BacktrackStep</a> <a href="src/Test-DejaFu-SCT-Internal.html#BacktrackStep" class="link">Source</a></p><div class="doc"><p>One step of the execution, including information for backtracking
 purposes. This backtracking information is used to generate new
 schedules.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:BacktrackStep" class="def">BacktrackStep</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:_threadid" class="def">_threadid</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></dt><dd class="doc"><p>The thread running at this step</p></dd><dt class="src"><a name="v:_decision" class="def">_decision</a> :: (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)</dt><dd class="doc"><p>What happened at this step.</p></dd><dt class="src"><a name="v:_runnable" class="def">_runnable</a> :: <a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-IntMap-Strict.html#t:IntMap">IntMap</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a></dt><dd class="doc"><p>The threads runnable at this step</p></dd><dt class="src"><a name="v:_backtrack" class="def">_backtrack</a> :: <a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-IntMap-Strict.html#t:IntMap">IntMap</a> <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc"><p>The list of alternative threads to run, and whether those
 alternatives were added conservatively due to the bound.</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:BacktrackStep" class="caption collapser" onclick="toggleSection('i:BacktrackStep')">Instances</p><div id="section.i:BacktrackStep" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Eq.html#t:Eq">Eq</a> <a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a></span> <a href="src/Test-DejaFu-SCT-Internal.html#line-39" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Show.html#t:Show">Show</a> <a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a></span> <a href="src/Test-DejaFu-SCT-Internal.html#line-39" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="https://hackage.haskell.org/package/deepseq-1.4.1.1/docs/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a></span> <a href="src/Test-DejaFu-SCT-Internal.html#line-41" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:sctBounded" class="def">sctBounded</a> <a href="src/Test-DejaFu-SCT.html#sctBounded" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a></td><td class="doc"><p>The memory model to use for non-synchronised <code>CRef</code> operations.</p></td></tr><tr><td class="src">-&gt; ([(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>)</td><td class="doc"><p>Check if a prefix trace is within the bound</p></td></tr><tr><td class="src">-&gt; ([<a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a>] -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; [<a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a>])</td><td class="doc"><p>Add a new backtrack point, this takes the history of the
 execution so far, the index to insert the backtracking point, and
 the thread to backtrack to. This may insert more than one
 backtracking point.</p></td></tr><tr><td class="src">-&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>) -&gt; <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>)</td><td class="doc"><p>Produce possible scheduling decisions, all will be tried.</p></td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:ConcST">ConcST</a> t a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>SCT via BPOR.</p><p>Schedules are generated by running the computation with a
 deterministic scheduler with some initial list of decisions, after
 which the supplied function is called. At each step of execution,
 possible-conflicting actions are looked for, if any are found,
 &quot;backtracking points&quot; are added, to cause the events to happen in
 a different order in a future execution.</p><p>Note that unlike with non-bounded partial-order reduction, this may
 do some redundant work as the introduction of a bound can make
 previously non-interfering events interfere with each other.</p></div></div><div class="top"><p class="src"><a name="v:sctBoundedIO" class="def">sctBoundedIO</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; ([(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; ([<a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a>] -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; [<a href="Test-DejaFu-SCT.html#t:BacktrackStep">BacktrackStep</a>]) -&gt; (<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>) -&gt; <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="Data-List-Extra.html#t:NonEmpty">NonEmpty</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a>) -&gt; <a href="Test-DejaFu-Deterministic.html#t:ConcIO">ConcIO</a> a -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a> [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)] <a href="src/Test-DejaFu-SCT.html#sctBoundedIO" class="link">Source</a></p><div class="doc"><p>Variant of <code><a href="Test-DejaFu-SCT.html#v:sctBounded">sctBounded</a></code> for computations which do <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a></code>.</p></div></div><h1 id="g:2">Pre-emption and Fair Bounding</h1><div class="doc"><p>BPOR using pre-emption bounding. This adds conservative
 backtracking points at the prior context switch whenever a
 non-conervative backtracking point is added, as alternative
 decisions can influence the reachability of different states.</p><p>See the BPOR paper for more details.</p></div><div class="top"><p class="src"><a name="v:sctPreBound" class="def">sctPreBound</a> <a href="src/Test-DejaFu-SCT.html#sctPreBound" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a></td><td class="doc"><p>The memory model to use for non-synchronised <code>CRef</code> operations.</p></td></tr><tr><td class="src">-&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The maximum number of pre-emptions to allow in a single
 execution</p></td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:ConcST">ConcST</a> t a)</td><td class="doc"><p>The computation to run many times</p></td></tr><tr><td class="src">-&gt; [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>An SCT runner using a pre-emption bounding scheduler.</p></div></div><div class="top"><p class="src"><a name="v:sctPreBoundIO" class="def">sctPreBoundIO</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic.html#t:ConcIO">ConcIO</a> a -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a> [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)] <a href="src/Test-DejaFu-SCT.html#sctPreBoundIO" class="link">Source</a></p><div class="doc"><p>Variant of <code><a href="Test-DejaFu-SCT.html#v:sctPreBound">sctPreBound</a></code> for computations which do <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a></code>.</p></div></div><div class="doc"><p>BPOR using fair bounding. This bounds the maximum difference
 between the number of yield operations different threads have
 performed.</p><p>See the BPOR paper for more details.</p></div><div class="top"><p class="src"><a name="v:sctFairBound" class="def">sctFairBound</a> <a href="src/Test-DejaFu-SCT.html#sctFairBound" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a></td><td class="doc"><p>The memory model to use for non-synchronised <code>CRef</code> operations.</p></td></tr><tr><td class="src">-&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The maximum difference between the number of yield operations
 performed by different threads.</p></td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:ConcST">ConcST</a> t a)</td><td class="doc"><p>The computation to run many times</p></td></tr><tr><td class="src">-&gt; [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>An SCT runner using a fair bounding scheduler.</p></div></div><div class="top"><p class="src"><a name="v:sctFairBoundIO" class="def">sctFairBoundIO</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic.html#t:ConcIO">ConcIO</a> a -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a> [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)] <a href="src/Test-DejaFu-SCT.html#sctFairBoundIO" class="link">Source</a></p><div class="doc"><p>Variant of <code><a href="Test-DejaFu-SCT.html#v:sctFairBound">sctFairBound</a></code> for computations which do <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a></code>.</p></div></div><div class="doc"><p>Combination pre-emption and fair bounding, this is what is used
 by the testing functionality in <code>Test.DejaFu</code>.</p></div><div class="top"><p class="src"><a name="v:sctPFBound" class="def">sctPFBound</a> <a href="src/Test-DejaFu-SCT.html#sctPFBound" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a></td><td class="doc"><p>The memory model to use for non-synchronised <code>CRef</code> operations.</p></td></tr><tr><td class="src">-&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The pre-emption bound</p></td></tr><tr><td class="src">-&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The fair bound</p></td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> t. <a href="Test-DejaFu-Deterministic.html#t:ConcST">ConcST</a> t a)</td><td class="doc"><p>The computation to run many times</p></td></tr><tr><td class="src">-&gt; [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>An SCT runner using a fair bounding scheduler.</p></div></div><div class="top"><p class="src"><a name="v:sctPFBoundIO" class="def">sctPFBoundIO</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:MemType">MemType</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Test-DejaFu-Deterministic.html#t:ConcIO">ConcIO</a> a -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a> [(<a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Either.html#t:Either">Either</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Failure">Failure</a> a, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a>)] <a href="src/Test-DejaFu-SCT.html#sctPFBoundIO" class="link">Source</a></p><div class="doc"><p>Variant of <code><a href="Test-DejaFu-SCT.html#v:sctPFBound">sctPFBound</a></code> for computations which do <code><a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#t:IO">IO</a></code>.</p></div></div><h1 id="g:3">Utilities</h1><div class="top"><p class="src"><a name="v:tidOf" class="def">tidOf</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> <a href="src/Test-DejaFu-SCT-Internal.html#tidOf" class="link">Source</a></p><div class="doc"><p>Get the resultant <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></code> of a <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a></code>, with a default case
 for <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#v:Continue">Continue</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:decisionOf" class="def">decisionOf</a> :: <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="https://hackage.haskell.org/package/containers-0.5.6.2/docs/Data-Set.html#t:Set">Set</a> <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a> <a href="src/Test-DejaFu-SCT-Internal.html#decisionOf" class="link">Source</a></p><div class="doc"><p>Get the <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a></code> that would have resulted in this <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></code>,
 given a prior <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a></code> (if any) and list of runnable threads.</p></div></div><div class="top"><p class="src"><a name="v:activeTid" class="def">activeTid</a> :: [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>] -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> <a href="src/Test-DejaFu-SCT-Internal.html#activeTid" class="link">Source</a></p><div class="doc"><p>Get the tid of the currently active thread after executing a
 series of decisions. The list MUST begin with a <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#v:Start">Start</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:preEmpCount" class="def">preEmpCount</a> :: [(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Test-DejaFu-SCT.html#preEmpCount" class="link">Source</a></p><div class="doc"><p>Count the number of pre-emptions in a schedule prefix.</p></div></div><div class="top"><p class="src"><a name="v:preEmpCount-39-" class="def">preEmpCount'</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Trace">Trace</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Test-DejaFu-SCT.html#preEmpCount%27" class="link">Source</a></p><div class="doc"><p>Count the number of pre-emptions in an entire trace</p></div></div><div class="top"><p class="src"><a name="v:yieldCount" class="def">yieldCount</a> :: <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadId">ThreadId</a> -&gt; [(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Test-DejaFu-SCT.html#yieldCount" class="link">Source</a></p><div class="doc"><p>Count the number of yields by a thread in a schedule prefix.</p></div></div><div class="top"><p class="src"><a name="v:maxYieldCountDiff" class="def">maxYieldCountDiff</a> :: [(<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a>)] -&gt; (<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Decision">Decision</a>, <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>) -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Test-DejaFu-SCT.html#maxYieldCountDiff" class="link">Source</a></p><div class="doc"><p>Get the maximum difference between the yield counts of all
 threads in this schedule prefix.</p></div></div><div class="top"><p class="src"><a name="v:initialCVState" class="def">initialCVState</a> :: <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a> <a href="src/Test-DejaFu-SCT-Internal.html#initialCVState" class="link">Source</a></p><div class="doc"><p>Initial global <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a></code> state</p></div></div><div class="top"><p class="src"><a name="v:updateCVState" class="def">updateCVState</a> :: <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:ThreadAction">ThreadAction</a> -&gt; <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a> <a href="src/Test-DejaFu-SCT-Internal.html#updateCVState" class="link">Source</a></p><div class="doc"><p>Update the <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#t:CVar">CVar</a></code> state with the action that has just happened.</p></div></div><div class="top"><p class="src"><a name="v:willBlock" class="def">willBlock</a> :: <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a> -&gt; <a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="src/Test-DejaFu-SCT-Internal.html#willBlock" class="link">Source</a></p><div class="doc"><p>Check if an action will block.</p></div></div><div class="top"><p class="src"><a name="v:willBlockSafely" class="def">willBlockSafely</a> :: <a href="Test-DejaFu-SCT-Internal.html#t:CVState">CVState</a> -&gt; [<a href="Test-DejaFu-Deterministic-Internal-Common.html#t:Lookahead">Lookahead</a>] -&gt; <a href="https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="src/Test-DejaFu-SCT-Internal.html#willBlockSafely" class="link">Source</a></p><div class="doc"><p>Check if a list of actions will block safely (without modifying
 any global state). This allows further lookahead at, say, the
 <code>spawn</code> of a thread (which always starts with <code><a href="Test-DejaFu-Deterministic-Internal-Common.html#v:KnowsAbout">KnowsAbout</a></code>).</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>